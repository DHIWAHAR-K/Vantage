# Vantage Large Model Configuration (24B parameters)
# Maximum accuracy for production use

model:
  name: "vantage-large-24b"
  hidden_size: 6144
  num_layers: 40
  num_attention_heads: 96
  num_key_value_heads: 24  # GQA for efficiency
  intermediate_size: 24576  # 4x hidden for dense layers
  
  # MoE Configuration
  num_experts: 64
  num_experts_per_token: 2  # Top-K sparse routing
  expert_capacity: 1.25  # 25% buffer for load balancing
  
  # Architecture
  vocab_size: 32000
  max_position_embeddings: 8192
  rope_theta: 10000.0
  rope_scaling: null
  
  # Regularization
  attention_dropout: 0.0
  hidden_dropout: 0.1
  expert_dropout: 0.1
  
  # Load Balancing
  router_aux_loss_coef: 0.01
  router_z_loss_coef: 0.001
  
  # Schema Encoder
  schema_encoder:
    num_layers: 8
    cross_attention_interval: 4  # Cross-attend every 4th layer

training:
  # Optimization
  batch_size: 8
  gradient_accumulation_steps: 4
  learning_rate: 1.0e-4
  weight_decay: 0.1
  adam_beta1: 0.9
  adam_beta2: 0.95
  adam_epsilon: 1.0e-8
  max_grad_norm: 1.0
  
  # Schedule
  num_train_steps: 300000
  warmup_steps: 3000
  lr_scheduler_type: "cosine"
  min_lr_ratio: 0.1
  
  # Precision & Memory
  mixed_precision: "bf16"
  gradient_checkpointing: true
  activation_checkpointing: true
  
  # Checkpointing
  save_steps: 5000
  eval_steps: 1000
  logging_steps: 100
  keep_checkpoint_max: 3
  
  # Data
  max_seq_length: 2048
  preprocessing_num_workers: 8

data:
  # Dataset Mix (proportions)
  spider_weight: 0.4
  bird_sql_weight: 0.3
  wiki_sql_weight: 0.2
  gretel_synthetic_weight: 0.1
  
  # Data Augmentation
  augmentation_prob: 0.5
  schema_perturbation_prob: 0.2
  
  # Validation
  validation_split: 0.05
  seed: 42

inference:
  # Generation
  max_new_tokens: 512
  temperature: 0.0  # Greedy for SQL
  top_p: 0.9
  top_k: 50
  num_beams: 4
  
  # Constraints
  constrained_decoding: true
  schema_aware: true
  
  # Performance
  batch_size: 4
  use_cache: true

evaluation:
  metrics:
    - exact_match
    - execution_accuracy
    - valid_sql
    - component_match
    - expert_utilization
    - latency
  
  benchmarks:
    - spider_dev
    - spider_test
    - bird_sql
    - wiki_sql
    - cosql
    - chase
  
  timeout: 10.0  # SQL execution timeout in seconds
